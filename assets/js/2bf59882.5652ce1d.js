"use strict";(self.webpackChunkfacturapi_docs=self.webpackChunkfacturapi_docs||[]).push([[3117],{3905:function(e,a,r){r.d(a,{Zo:function(){return u},kt:function(){return m}});var t=r(7294);function n(e,a,r){return a in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function o(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),r.push.apply(r,t)}return r}function i(e){for(var a=1;a<arguments.length;a++){var r=null!=arguments[a]?arguments[a]:{};a%2?o(Object(r),!0).forEach((function(a){n(e,a,r[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))}))}return e}function l(e,a){if(null==e)return{};var r,t,n=function(e,a){if(null==e)return{};var r,t,n={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],a.indexOf(r)>=0||(n[r]=e[r]);return n}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],a.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=t.createContext({}),s=function(e){var a=t.useContext(c),r=a;return e&&(r="function"==typeof e?e(a):i(i({},a),e)),r},u=function(e){var a=s(e.components);return t.createElement(c.Provider,{value:a},e.children)},d={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},p=t.forwardRef((function(e,a){var r=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=s(r),m=n,v=p["".concat(c,".").concat(m)]||p[m]||d[m]||o;return r?t.createElement(v,i(i({ref:a},u),{},{components:r})):t.createElement(v,i({ref:a},u))}));function m(e,a){var r=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=p;var l={};for(var c in a)hasOwnProperty.call(a,c)&&(l[c]=a[c]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var s=2;s<o;s++)i[s]=r[s];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}p.displayName="MDXCreateElement"},4661:function(e,a,r){r.r(a),r.d(a,{assets:function(){return u},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return d}});var t=r(3117),n=r(102),o=(r(7294),r(3905)),i=["components"],l={sidebar_position:6},c="Migrar de v1 a v2",s={unversionedId:"migrate",id:"migrate",title:"Migrar de v1 a v2",description:"Cambios generales",source:"@site/docs/migrate.md",sourceDirName:".",slug:"/migrate",permalink:"/docs/migrate",editUrl:"https://github.com/facturapi/facturapi-docs/edit/main/website/docs/migrate.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Formato de fechas",permalink:"/docs/advanced/dates"}},u={},d=[{value:"Cambios generales",id:"cambios-generales",level:2},{value:"Facturas",id:"facturas",level:2},{value:"Nuevos campos requeridos al crear clientes:",id:"nuevos-campos-requeridos-al-crear-clientes",level:3},{value:"Nuevos campos opcionales al crear productos:",id:"nuevos-campos-opcionales-al-crear-productos",level:3},{value:"Nuevos campos opcionales al crear facturas:",id:"nuevos-campos-opcionales-al-crear-facturas",level:3},{value:"Documentos relacionados en facturas",id:"documentos-relacionados-en-facturas",level:3},{value:"Facturas de Egreso (Notas de Cr\xe9dito)",id:"facturas-de-egreso-notas-de-cr\xe9dito",level:3},{value:"Factura global",id:"factura-global",level:3},{value:"Usando el m\xe9todo Crear Factura Global ",id:"usando-el-m\xe9todo-crear-factura-global-",level:4},{value:"Usando el m\xe9todo Crear Factura",id:"usando-el-m\xe9todo-crear-factura",level:4},{value:"Acuse de recibo de cancelaci\xf3n",id:"acuse-de-recibo-de-cancelaci\xf3n",level:3},{value:"Comprobante de tipo Pago (recibo electr\xf3nico de pagos)",id:"comprobante-de-tipo-pago-recibo-electr\xf3nico-de-pagos",level:3},{value:"Comprobante de Retenciones (e informaci\xf3n de pagos)",id:"comprobante-de-retenciones-e-informaci\xf3n-de-pagos",level:2},{value:"Organizaciones",id:"organizaciones",level:2},{value:"Llaves secretas o Api Keys",id:"llaves-secretas-o-api-keys",level:3},{value:"Configuraci\xf3n de recibos",id:"configuraci\xf3n-de-recibos",level:3}],p={toc:d};function m(e){var a=e.components,r=(0,n.Z)(e,i);return(0,o.kt)("wrapper",(0,t.Z)({},p,r,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"migrar-de-v1-a-v2"},"Migrar de v1 a v2"),(0,o.kt)("h2",{id:"cambios-generales"},"Cambios generales"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"La nueva URL de la API es ",(0,o.kt)("inlineCode",{parentName:"li"},"https://www.facturapi.io/v2"),"."),(0,o.kt)("li",{parentName:"ul"},"Si usas una de nuestras librer\xedas, aseg\xfarate de actualizar a la \xfaltima versi\xf3n mayor para usar el nuevo endpoint."),(0,o.kt)("li",{parentName:"ul"},"Ya no se permite enviar atributos desconocidos, es decir, que no formen parte de la estructura descrita en la documentaci\xf3n. Ahora, si se env\xeda un atributo desconocido, la API devolver\xe1 un error."),(0,o.kt)("li",{parentName:"ul"},"El SAT ahora valida, tanto en el emisor como en el receptor, que el RFC coincida exactamente con la raz\xf3n social y el domicilio registrados en el SAT, por lo que deber\xe1s revisar los datos del emisor y el receptor antes de enviar la factura."),(0,o.kt)("li",{parentName:"ul"},"Si env\xedas fechas en formato ISO 8601 y no incluyes la zona horaria, ahora la API la interpretar\xe1 como tu hora local (definida por el c\xf3digo postal de tu organizaci\xf3n), en lugar de interpretarla como UTC. Puedes leer m\xe1s a fondo en ",(0,o.kt)("a",{parentName:"li",href:"https://www.facturapi.io/docs/advanced/dates"},"este art\xedculo"),".")),(0,o.kt)("h2",{id:"facturas"},"Facturas"),(0,o.kt)("h3",{id:"nuevos-campos-requeridos-al-crear-clientes"},"Nuevos campos requeridos al crear clientes:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"tax_system")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"address.zip"))),(0,o.kt)("h3",{id:"nuevos-campos-opcionales-al-crear-productos"},"Nuevos campos opcionales al crear productos:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"taxability"))),(0,o.kt)("h3",{id:"nuevos-campos-opcionales-al-crear-facturas"},"Nuevos campos opcionales al crear facturas:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"items.third_party")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"export")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"global"))),(0,o.kt)("h3",{id:"documentos-relacionados-en-facturas"},"Documentos relacionados en facturas"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Ahora una factura puede tener m\xe1s de un tipo de relaci\xf3n con otros documentos,\npor lo que la forma de indicar documentos relacionados cambia de la siguiente manera:"),(0,o.kt)("p",{parentName:"li"},"Antes:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "relation": "01",\n  "related": ["81DA4E74-4924-4934-8129-497498E076A0"]\n}\n')),(0,o.kt)("p",{parentName:"li"},"Ahora:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "related_documents": [\n    {\n      "relationship": "01",\n      "documents": ["81DA4E74-4924-4934-8129-497498E076A0"]\n    }\n  ]\n}\n')))),(0,o.kt)("h3",{id:"facturas-de-egreso-notas-de-cr\xe9dito"},"Facturas de Egreso (Notas de Cr\xe9dito)"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Se elimina el atributo ",(0,o.kt)("inlineCode",{parentName:"li"},"products")," y en su lugar se introduce el arreglo ",(0,o.kt)("inlineCode",{parentName:"li"},"items"),", igual que en los dem\xe1s tipos de facturas.")),(0,o.kt)("h3",{id:"factura-global"},"Factura global"),(0,o.kt)("p",null,"Al crear una factura global, ahora es requerido enviar informaci\xf3n adicional:"),(0,o.kt)("h4",{id:"usando-el-m\xe9todo-crear-factura-global-"},"Usando el m\xe9todo ",(0,o.kt)("a",{parentName:"h4",href:"/api/#operation/createGlobalInvoice"},"Crear Factura Global ")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Nuevo atributo ",(0,o.kt)("inlineCode",{parentName:"li"},"periodicity"),". Es opcional porque de omitirse se tomar\xe1 de la\nconfiguraci\xf3n de recibos de la organizaci\xf3n, pero es importante asegurarse de\nque efectivamente tenga el valor que quieres que salga en la factura."),(0,o.kt)("li",{parentName:"ul"},"El rango de fechas que se forma de los atributos ",(0,o.kt)("inlineCode",{parentName:"li"},"from")," y ",(0,o.kt)("inlineCode",{parentName:"li"},"to")," debe coincidir\ncon el periodo definido por medio del atributo ",(0,o.kt)("inlineCode",{parentName:"li"},"periodicity"),".")),(0,o.kt)("h4",{id:"usando-el-m\xe9todo-crear-factura"},"Usando el m\xe9todo ",(0,o.kt)("a",{parentName:"h4",href:"/api/#operation/crateInvoice"},"Crear Factura")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Nuevo atributo ",(0,o.kt)("inlineCode",{parentName:"li"},"global"),", que es un objeto con los atributos ",(0,o.kt)("inlineCode",{parentName:"li"},"periodicity"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"months")," y ",(0,o.kt)("inlineCode",{parentName:"li"},"year"),".")),(0,o.kt)("h3",{id:"acuse-de-recibo-de-cancelaci\xf3n"},"Acuse de recibo de cancelaci\xf3n"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Anteriormente, era posible obtener el acuse de cancelaci\xf3n de una factura cancelada por medio de la\npropiedad ",(0,o.kt)("inlineCode",{parentName:"li"},"cancellation_receipt")," del objeto ",(0,o.kt)("inlineCode",{parentName:"li"},"Invoice"),". Ahora la manera de obtener el acuse de cancelaci\xf3n es\nmediante el m\xe9todo ",(0,o.kt)("a",{parentName:"li",href:"/api/#operation/getCancellationReceipt"},"Obtener Acuse de Cancelaci\xf3n"),".")),(0,o.kt)("h3",{id:"comprobante-de-tipo-pago-recibo-electr\xf3nico-de-pagos"},"Comprobante de tipo Pago (recibo electr\xf3nico de pagos)"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"La informaci\xf3n del ocmplemento de Pago ya no se enviar\xe1 por medio del atributo ",(0,o.kt)("inlineCode",{parentName:"li"},"payments"),", sino que se incluir\xe1 como complemento con tipo ",(0,o.kt)("inlineCode",{parentName:"li"},"pago")," en una factura de tipo ",(0,o.kt)("inlineCode",{parentName:"li"},"P")," (Pago).")),(0,o.kt)("h2",{id:"comprobante-de-retenciones-e-informaci\xf3n-de-pagos"},"Comprobante de Retenciones (e informaci\xf3n de pagos)"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Se elimina el atributo ",(0,o.kt)("inlineCode",{parentName:"li"},"totales.imp_retenidos[].pago_provisional")," y en su lugar debe usarse el nuevo atributo ",(0,o.kt)("inlineCode",{parentName:"li"},"totales.imp_retenidos[].tipo_pago_ret"),".")),(0,o.kt)("h2",{id:"organizaciones"},"Organizaciones"),(0,o.kt)("h3",{id:"llaves-secretas-o-api-keys"},"Llaves secretas o Api Keys"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Como medida de seguridad, ya no es posible obtener la llave secreta Live de una organizaci\xf3n. Se elimina el m\xe9todo ",(0,o.kt)("inlineCode",{parentName:"li"},"getApiKeys")," y en su lugar se introducen los m\xe9todos ",(0,o.kt)("inlineCode",{parentName:"li"},"getTestApiKey"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"renewTestApiKey")," y ",(0,o.kt)("inlineCode",{parentName:"li"},"renewLiveApiKey"),". Los dos \xfaltimos pueden ser usados para generar nuevas llaves secretas, sustituyendo a las actuales, y en la respuesta se incluye la nueva llave generada. Para el caso de la llave secreta Live, el momento de su creaci\xf3n ser\xe1 la \xfanica\noportunidad para leer el valor.")),(0,o.kt)("h3",{id:"configuraci\xf3n-de-recibos"},"Configuraci\xf3n de recibos"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"La propiedad ",(0,o.kt)("inlineCode",{parentName:"li"},"organization.receipts.invoice_period")," fue renombrada\na ",(0,o.kt)("inlineCode",{parentName:"li"},"organization.receipts.periodicity"),"."),(0,o.kt)("li",{parentName:"ul"},"Se elimin\xf3 la propiedad ",(0,o.kt)("inlineCode",{parentName:"li"},"organization.receipts.ask_address"),". Ahora en el portal de autofactura siempre\nse solicita el domicilio fiscal.")))}m.isMDXComponent=!0}}]);